# ì•ˆë“œë¡œì´ë“œ ì•±ì—ì„œ API í˜¸ì¶œí•˜ê¸°
## âœ… Retrofit ì„¤ì • (ì¶”ì²œ)
- ì•ˆë“œë¡œì´ë“œì—ì„œ ì„œë²„ APIë¥¼ í˜¸ì¶œí•˜ë ¤ë©´ Retrofitì„ ì„¤ì •í•´ì•¼ í•´.
  * ë„¤íŠ¸ì›Œí¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ => Retrofit

### 01. build.gradleì— Retrofit ì¶”ê°€

```
dependencies {
 // Retrofit
    implementation 'com.squareup.retrofit2:retrofit:2.9.0'
    implementation 'com.squareup.retrofit2:converter-gson:2.9.0' // JSON ë³€í™˜ê¸°
  
 // OkHttp (ë„¤íŠ¸ì›Œí¬ ë¡œê·¸ í™•ì¸ìš©)  
    implementation("com.squareup.okhttp3:logging-interceptor:4.9.3")
}
```
### 01-2. AndroidManifest.xml : ì¸í„°ë„· ì ‘ê·¼ ê¶Œí•œ ì„¤ì •

> "<uses-permission android:name="android.permission.INTERNET" />"



### 02. Retrofit ì„¤ì •í•˜ê¸° (Retrofit ì¸í„°í˜ì´ìŠ¤ ì •ì˜ â†’ API ìš”ì²­ ì •ì˜)
- Spring Boot ë°±ì—”ë“œì—ì„œ ì œê³µí•˜ëŠ” API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì •ì˜
```
ApiService.kt : 

import retrofit2.Call
import retrofit2.http.GET
import retrofit2.http.POST
import retrofit2.http.Body

interface ApiService {
    @GET("/api/guestbook")
    fun getGuestbookEntries(): Call<List<Guestbook>>

    @POST("/api/auth/login")
    fun login(@Body request: LoginRequest): Call<LoginResponse>
}

```

### 03.  Retrofit ì¸ìŠ¤í„´ìŠ¤ ìƒì„± â†’ Retrofit ì„¤ì •
- Retrofitì„ ì‚¬ìš©í•˜ì—¬ API í˜¸ì¶œì„ ìˆ˜í–‰í•˜ë„ë¡ ì„¤ì •
```
RetrofitClient.kt

import retrofit2.Retrofit
import retrofit2.converter.gson.GsonConverterFactory

object RetrofitClient {
    private const val BASE_URL = "http://your-server-url.com"

    val instance: ApiService by lazy {
        Retrofit.Builder()
            .baseUrl(BASE_URL)
            .addConverterFactory(GsonConverterFactory.create())
            .build()
            .create(ApiService::class.java)
    }
}

- ì„œë²„ ì£¼ì†Œ (BASE_URL)ëŠ” í˜„ì¬ ìš´ì˜ ì¤‘ì¸ Spring Boot ë°±ì—”ë“œ ì£¼ì†Œë¡œ ë³€ê²½
- ì•ˆë“œë¡œì´ë“œ ì•±ì—ì„œ Spring Boot ì„œë²„ê°€ HTTPSê°€ ì•„ë‹ˆë¼ë©´ ë„¤íŠ¸ì›Œí¬ ì •ì±…ì„ ë³€ê²½í•´ì•¼ í•  ìˆ˜ë„ ìˆìŒ
```
### 03-2. models/ íŒ¨í‚¤ì§€ì— API ì‘ë‹µ ë°ì´í„° í´ë˜ìŠ¤ ì¶”ê°€(dto)
```
package dcu.fossilfuel.api.models

data class Guestbook(
    val id: Long,
    val message: String,
    val author: String
)
package dcu.fossilfuel.api.models

data class LoginRequest(
    val username: String,
    val password: String
)
package dcu.fossilfuel.api.models

data class LoginResponse(
    val token: String,
    val userId: Long
)



```


### 04. API í˜¸ì¶œ ì–´ë””ì„œ í• ì§€
- ui/ íŒ¨í‚¤ì§€ì— í™”ë©´ ì¶”ê°€ (ì˜ˆ: ë¡œê·¸ì¸, ë°©ëª…ë¡) 
  * LoginScreen.kt â†’ ë¡œê·¸ì¸ í™”ë©´ì—ì„œ API í˜¸ì¶œ
- viewmodel/ íŒ¨í‚¤ì§€ì— ViewModel ì¶”ê°€ (ì„ íƒ)
  * GuestbookViewModel.kt â†’ MVVM íŒ¨í„´ ì‚¬ìš© ì‹œ

```
âœ” API í˜¸ì¶œì„ ìœ„í•œ Retrofit ì„¤ì • (api/ íŒ¨í‚¤ì§€)
âœ” Spring Bootì™€ í†µì‹ í•  ë°ì´í„° ëª¨ë¸ ì •ì˜ (models/ íŒ¨í‚¤ì§€)
âœ” UIì—ì„œ API í˜¸ì¶œí•˜ëŠ” ì½”ë“œ ì‘ì„± (ui/ íŒ¨í‚¤ì§€)
âœ” MVVM íŒ¨í„´ì„ ì‚¬ìš©í•˜ë ¤ë©´ ViewModel ì¶”ê°€ (viewmodel/ íŒ¨í‚¤ì§€)
```


- (í˜„ì¬ëŠ” ì•„ë˜, main ì—ì„œ í˜¸ì¶œ ì¤‘)
```

RetrofitClient.instance.getGuestbookEntries().enqueue(object : Callback<List<Guestbook>> {
    override fun onResponse(call: Call<List<Guestbook>>, response: Response<List<Guestbook>>) {
        if (response.isSuccessful) {
            val guestbookEntries = response.body()
            Log.d("API", "ë°ì´í„°: $guestbookEntries")
        }
    }

    override fun onFailure(call: Call<List<Guestbook>>, t: Throwable) {
        Log.e("API", "ì‹¤íŒ¨: ${t.message}")
    }
})
```

### 05. ì˜ˆì‹œ ë””ë ‰í† ë¦¬ êµ¬ì¡°
```angular2html
case1:
app/
 â”œâ”€â”€ src/
 â”‚   â”œâ”€â”€ main/
 â”‚   â”‚   â”œâ”€â”€ java/dcu/fossilfuel/
 â”‚   â”‚   â”‚   â”œâ”€â”€ api/                     <-- ğŸ“Œ Retrofit ê´€ë ¨ ì½”ë“œ ì¶”ê°€
 â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ApiService.kt        <-- Retrofit ì¸í„°í˜ì´ìŠ¤
 â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ RetrofitClient.kt    <-- Retrofit ì„¤ì •
 â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ models/              <-- API ì‘ë‹µ ë°ì´í„° í´ë˜ìŠ¤
 â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Guestbook.kt      <-- ë°©ëª…ë¡ ë°ì´í„° ëª¨ë¸
 â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoginRequest.kt   <-- ë¡œê·¸ì¸ ìš”ì²­ ë°ì´í„°
 â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoginResponse.kt  <-- ë¡œê·¸ì¸ ì‘ë‹µ ë°ì´í„°
 â”‚   â”‚   â”‚   â”œâ”€â”€ ui/                      <-- UI ê´€ë ¨ ì½”ë“œ
 â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MainActivity.kt      <-- ì•±ì˜ ë©”ì¸ ì•¡í‹°ë¹„í‹°
 â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ GuestbookScreen.kt   <-- ë°©ëª…ë¡ í™”ë©´
 â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoginScreen.kt       <-- ë¡œê·¸ì¸ í™”ë©´
 â”‚   â”‚   â”‚   â”œâ”€â”€ viewmodel/               <-- ViewModel (MVVM íŒ¨í„´ ì‚¬ìš© ì‹œ)
 â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ GuestbookViewModel.kt
 â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoginViewModel.kt


```

```angular2html
case2:
/project-root
  â”œâ”€â”€ app/src/main/java/com/example/app
  â”‚   â”œâ”€â”€ data/          # ë°ì´í„° ê´€ë ¨ (Entity, Repository, API)
  â”‚   â”‚   â”œâ”€â”€ model/     # DTO ë° ë°ì´í„° ëª¨ë¸ í´ë˜ìŠ¤
  â”‚   â”‚   â”œâ”€â”€ repository/ # ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ (RoomDB, Retrofit ë“±)
  â”‚   â”œâ”€â”€ ui/            # UI ê´€ë ¨ (Activity, Fragment, ViewModel)
  â”‚   â”‚   â”œâ”€â”€ main/      # ë©”ì¸ í™”ë©´ ê´€ë ¨ UI
  â”‚   â”‚   â”œâ”€â”€ profile/   # í”„ë¡œí•„ ê´€ë ¨ UI
  â”‚   â”œâ”€â”€ viewmodel/     # MVVM íŒ¨í„´ì˜ ViewModel í´ë˜ìŠ¤
  â”œâ”€â”€ app/src/main/res/  # XML ë ˆì´ì•„ì›ƒ ë° ë¦¬ì†ŒìŠ¤ íŒŒì¼
  â”œâ”€â”€ app/src/main/AndroidManifest.xml # ì•± ì„¤ì • íŒŒì¼
  â”œâ”€â”€ build.gradle.kts  # Gradle ë¹Œë“œ ì„¤ì • íŒŒì¼

```

